# Code generated by smithy-python-codegen DO NOT EDIT.

from typing import Any

from smithy_python._private import tuples_to_fields
from smithy_python._private.http import HTTPResponse as _HTTPResponse
from smithy_python.async_utils import async_list
from smithy_python.interfaces import Fields
from smithy_python.interfaces.http import (
    HTTPRequest,
    HTTPRequestConfiguration,
    HTTPResponse,
)

from echo.errors import ServiceError


class TestHttpServiceError(ServiceError):
    """A test error that subclasses the service-error for protocol tests."""

    def __init__(self, request: HTTPRequest):
        self.request = request

class RequestTestHTTPClient:
    """An asynchronous HTTP client solely for testing purposes."""

    async def send(
        self, *, request: HTTPRequest, request_config: HTTPRequestConfiguration | None
    ) -> HTTPResponse:
        # Raise the exception with the request object to bypass actual request handling
        raise TestHttpServiceError(request)

class ResponseTestHTTPClient:
    """An asynchronous HTTP client solely for testing purposes."""

    def __init__(self, status: int, headers: list[tuple[str, str]], body: bytes):
        self.status = status
        self.fields = tuples_to_fields(headers)
        self.body = body

    async def send(
        self, *, request: HTTPRequest, request_config: HTTPRequestConfiguration | None
    ) -> _HTTPResponse:
        # Pre-construct the response from the request and return it
        return _HTTPResponse(
            status=self.status,
            fields=self.fields,
            body=async_list([self.body]),
        )
